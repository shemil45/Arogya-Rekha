<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Worker Registration</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" />
    <link rel="stylesheet" href="../../css/main.css" />
    <link rel="stylesheet" href="../../css/mobile.css" />
  </head>
  <body>
    <div class="container py-3" style="max-width: 640px;">
      <a href="./language-select.html" class="text-decoration-none small">&larr; Back</a>
      <h1 class="h4 fw-bold mt-2">Registration | নিবন্ধন | पंजीकरण | രജിസ്ട്രേഷൻ</h1>
      <p class="text-muted small">Please enter your details</p>

      <form id="regForm" novalidate class="card border-0 shadow-sm p-3 mobile-card">
        <div class="row g-3">
          <div class="col-12">
            <label class="form-label">Name (नाम / নাম)</label>
            <input type="text" class="form-control" name="name" required />
            <div class="invalid-feedback">Name is required</div>
          </div>
          <div class="col-6">
            <label class="form-label">Age (उम्र)</label>
            <input type="number" min="1" max="100" class="form-control" name="age" required />
            <div class="invalid-feedback">Valid age required</div>
          </div>
          <div class="col-6">
            <label class="form-label">Gender (लिंग)</label>
            <select class="form-select" name="gender" required>
              <option value="" selected disabled>Choose</option>
              <option>Male</option>
              <option>Female</option>
              <option>Other</option>
            </select>
            <div class="invalid-feedback">Select gender</div>
          </div>
          <div class="col-12">
            <label class="form-label">Home State (राज्य)</label>
            <select class="form-select" name="homeState" required>
              <option value="" selected disabled>Choose</option>
              <option>West Bengal</option>
              <option>Odisha</option>
              <option>Uttar Pradesh</option>
              <option>Bihar</option>
              <option>Jharkhand</option>
            </select>
            <div class="invalid-feedback">Select home state</div>
          </div>
          <div class="col-12">
            <label class="form-label">Phone (फ़ोन)</label>
            <input type="tel" class="form-control" name="phone" pattern="[0-9]{10}" placeholder="10-digit number" required />
            <div class="invalid-feedback">10-digit phone required</div>
          </div>
          <div class="col-12">
            <label class="form-label">Current Location (Kerala)</label>
            <select class="form-select" name="district" required>
              <option value="" selected disabled>District</option>
              <option>Thiruvananthapuram</option>
              <option>Kollam</option>
              <option>Alappuzha</option>
              <option>Ernakulam</option>
              <option>Thrissur</option>
              <option>Palakkad</option>
              <option>Malappuram</option>
              <option>Kozhikode</option>
              <option>Wayanad</option>
              <option>Kannur</option>
              <option>Kasaragod</option>
            </select>
            <div class="invalid-feedback">Select district</div>
          </div>
        </div>
        <div class="d-grid mt-3">
          <button class="btn btn-success btn-lg" type="submit">Generate Health ID</button>
        </div>
      </form>

      <div class="app-toast" role="status" aria-live="polite"></div>
    </div>

    <script src="../../js/main.js"></script>
    <script>
      const form = document.getElementById('regForm');
      form.addEventListener('submit', (e) => {
        e.preventDefault();
        // simple validation
        if (!form.checkValidity()) {
          form.classList.add('was-validated');
          App.showToast('Please correct highlighted fields', 'error');
          return;
        }

        const fd = new FormData(form);
        const worker = {
          healthId: App.generateHealthId(),
          name: fd.get('name').trim(),
          age: Number(fd.get('age')),
          gender: fd.get('gender'),
          homeState: fd.get('homeState'),
          phone: '+91 ' + fd.get('phone'),
          currentLocation: { district: fd.get('district') },
          history: [],
          records: []
        };
        App.saveWorker(worker);
        App.setSelectedWorker(worker.healthId);
        App.showToast('Health ID generated');
        setTimeout(() => { window.location.href = './health-id.html'; }, 800);
      });
    </script>
  </body>
  </html>

